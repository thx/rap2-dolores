webpackJsonp([4],{30:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),s=o(1),c=r(s),u=o(17),p=r(u),f=o(14),d=o(16),m=(o(21),o(6)),y=o(11),h=function(){return{name:"",description:"",members:[],ownerId:void 0,organizationId:void 0,collaboratorIds:[]}},b=function(e){function t(e){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));v.call(o);var r=e.repository;return o.state=r?Object.assign({},r,{collaboratorIds:r.collaborators.map(function(e){return e.id}),newOwner:r.owner}):h(),o}return i(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.context.rmodal,o=this.props.auth;return c.default.createElement("section",{className:"RepositoryForm"},c.default.createElement("div",{className:"rmodal-header"},c.default.createElement("span",{className:"rmodal-title"},this.props.title)),c.default.createElement(m.RParsley,{ref:function(t){e.rparsley=t}},c.default.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},c.default.createElement("div",{className:"rmodal-body"},this.state.id&&c.default.createElement("div",{className:"form-group row"},c.default.createElement("label",{className:"col-sm-2 control-label"},"拥有者："),c.default.createElement("div",{className:"col-sm-10"},this.state.owner&&this.state.owner.id===o.id?c.default.createElement(m.MembersInput,{value:this.state.newOwner?[this.state.newOwner]:[],limit:1,onChange:function(t){return e.setState({newOwner:t[0]})}}):c.default.createElement("div",{className:"pt7 pl9"},this.state.owner.fullname))),c.default.createElement("div",{className:"form-group row"},c.default.createElement("label",{className:"col-sm-2 control-label"},"名称："),c.default.createElement("div",{className:"col-sm-10"},c.default.createElement("input",{name:"name",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})},className:"form-control",placeholder:"Name",spellCheck:"false",autoComplete:"off",autoFocus:"true",required:!0,"data-parsley-trigger":"change keyup","data-parsley-maxlength":"256"}))),c.default.createElement("div",{className:"form-group row"},c.default.createElement("label",{className:"col-sm-2 control-label"},"简介："),c.default.createElement("div",{className:"col-sm-10"},c.default.createElement(m.SmartTextarea,{name:"description",value:this.state.description,onChange:function(t){return e.setState({description:t.target.value})},className:"form-control",placeholder:"Description",spellCheck:"false",rows:"5","data-parsley-trigger":"change keyup","data-parsley-maxlength":"1024"}))),c.default.createElement("div",{className:"form-group row"},c.default.createElement("label",{className:"col-sm-2 control-label"},"成员："),c.default.createElement("div",{className:"col-sm-10"},c.default.createElement(m.MembersInput,{value:this.state.members,onChange:function(t){return e.setState({members:t})}}))),c.default.createElement("div",{className:"form-group row"},c.default.createElement("label",{className:"col-sm-2 control-label"},"协同仓库："),c.default.createElement("div",{className:"col-sm-10"},c.default.createElement("input",{name:"name",value:this.state.collaboratorIds.join(","),onChange:function(t){return e.setState({collaboratorIds:t.target.value.split(",")})},className:"form-control",placeholder:"Collaborator Ids",spellCheck:"false",autoComplete:"off"}),c.default.createElement("div",{className:"mt6 color-9"},c.default.createElement(y.GoInfo,{className:"mr3"}),"指定与哪些仓库共享接口，仓库 ID 之间用逗号分隔，例如 ",c.default.createElement("code",null,"1,2,3"),"。")))),c.default.createElement("div",{className:"rmodal-footer"},c.default.createElement("div",{className:"form-group row mb0"},c.default.createElement("label",{className:"col-sm-2 control-label"}),c.default.createElement("div",{className:"col-sm-10"},c.default.createElement("button",{type:"submit",className:"btn btn-success w140 mr20"},"提交"),c.default.createElement(d.Link,{to:"",onClick:function(e){e.preventDefault(),t.close()},className:"mr10"},"取消")))))))}},{key:"componentDidUpdate",value:function(){this.context.rmodal.reposition()}}]),t}(s.Component);b.contextTypes={rmodal:p.default.object.isRequired,onAddRepository:p.default.func.isRequired,onUpdateRepository:p.default.func.isRequired},b.propTypes={auth:p.default.object.isRequired,organization:p.default.object,repository:p.default.object};var v=function(){var e=this;this.handleSubmit=function(t){if(t.preventDefault(),e.rparsley.isValid()){var o=e.context,r=o.onAddRepository,a=o.onUpdateRepository,n=e.state.id?a:r,i=e.props.organization,l=Object.assign({},e.state,{organizationId:i?i.id:null,memberIds:(e.state.members||[]).map(function(e){return e.id})}),s=e.state,c=s.owner,u=s.newOwner;u&&u.id!==c.id&&(l.ownerId=u.id),n(l,function(){var t=e.context.rmodal;t&&t.resolve()})}}},g=function(e){return{auth:e.auth}},R={};t.default=(0,f.connect)(g,R)(b)},52:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),s=o(1),c=r(s),u=o(5),p=o(6),f=o(18),d=o(30),m=r(d),y=o(11),h=function(e){function t(e){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.handleDeleteRepository=function(e){e.preventDefault();var t=o.props.repository,r="仓库被删除后不可恢复，并且会删除相关的模块和接口！\n确认继续删除『#"+t.id+" "+t.name+"』吗？";if(window.confirm(r)){var a=o.context.onDeleteRepository;a(t.id);var n=o.context,i=n.store,l=n.location,s=l.pathname,c=l.hash,p=l.search;i.dispatch((0,u.replace)(s+c+p))}},o.handleUpdateRepository=function(e){var t=o.context.store,r=(0,u.StoreStateRouterLocationURI)(t);t.dispatch((0,u.replace)(r.href()))},o.state={update:!1},o}return i(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.context.location,o=this.props,r=o.auth,a=o.repository,n=o.editor;return c.default.createElement("div",{className:"Repository card"},c.default.createElement("div",{className:"card-block"},c.default.createElement("div",{className:"name"},c.default.createElement(y.GoRepo,{className:"mr6 color-9"}),c.default.createElement(u.Link,{to:n+"?id="+a.id},a.name)),c.default.createElement("div",{className:"desc"},a.description),c.default.createElement("div",{className:"toolbar"},c.default.createElement(u.Link,{to:f.serve+"/app/plugin/"+a.id,target:"_blank"},c.default.createElement(y.GoPlug,null)),a.owner.id===r.id||a.members.find(function(e){return e.id===r.id})?c.default.createElement("span",{className:"fake-link",onClick:function(t){return e.setState({update:!0})}},c.default.createElement(y.GoPencil,null)):null,c.default.createElement(p.RModal,{when:this.state.update,onClose:function(t){return e.setState({update:!1})},onResolve:this.handleUpdateRepository},c.default.createElement(m.default,{title:"编辑仓库",repository:a})),a.organization||a.owner.id!==r.id?null:c.default.createElement(u.Link,{to:t.pathname+t.search,onClick:this.handleDeleteRepository},c.default.createElement(y.GoTrashcan,null)))),c.default.createElement("div",{className:"card-block card-footer"},a.organization?c.default.createElement("span",{className:"ownername"},c.default.createElement(y.GoOrganization,null)," ",a.organization.name):c.default.createElement("span",{className:"ownername"},c.default.createElement(y.GoPerson,null)," ",a.owner.fullname),c.default.createElement("span",{className:"fromnow"},(0,u.moment)(a.updatedAt).fromNow(),"更新")))}}]),t}(s.Component);h.contextTypes={store:u.PropTypes.object,location:u.PropTypes.object,onDeleteRepository:u.PropTypes.func};var b=function(e){return{auth:e.auth}},v={};t.default=(0,u.connect)(b,v)(h)},53:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),s=o(1),c=r(s),u=o(5),p=o(52),f=r(p),d=function(e){function t(){return a(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.name,o=e.repositories,r=e.editor;return o.length?c.default.createElement("div",{className:"RepositoryList row"},o.map(function(e){return c.default.createElement("div",{key:e.id,className:"col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3"},c.default.createElement(f.default,{repository:e,editor:r}))})):t?c.default.createElement("div",{className:"fontsize-14 text-center p40"},"没有找到匹配 ",c.default.createElement("strong",null,t)," 的仓库。"):c.default.createElement("div",{className:"fontsize-14 text-center p40"},"没有数据。")}}]),t}(s.Component);d.propTypes={name:u.PropTypes.string,repositories:u.PropTypes.array.isRequired,editor:u.PropTypes.string.isRequired},t.default=d},54:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(){var e=this.props,t=e.history,o=e.location,r=e.match,a=e.onAddRepository,n=e.onUpdateRepository,i=e.onDeleteRepository;return{history:t,location:o,match:r,onAddRepository:a,onUpdateRepository:n,onDeleteRepository:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationWithLocation=t.OrganizationRepositoryListWithSpin=t.RepositoryListWithSpin=t.SearchGroup=t.RepositoriesTypeDropdown=t.CreateButton=t.mapDispatchToProps=t.childContextTypes=t.contextTypes=void 0;var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}();t.getChildContext=l;var c=o(1),u=r(c),p=o(5),f=o(6),d=o(53),m=r(d),y=o(30),h=r(y),b=o(37),v=o(11),g=(t.contextTypes={store:p.PropTypes.object},t.childContextTypes={history:p.PropTypes.object,location:p.PropTypes.object,match:p.PropTypes.object,onAddRepository:p.PropTypes.func,onUpdateRepository:p.PropTypes.func,onDeleteRepository:p.PropTypes.func},t.mapDispatchToProps={onAddRepository:b.addRepository,onUpdateRepository:b.updateRepository,onDeleteRepository:b.deleteRepository},t.CreateButton=function(e){function t(e){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.handleUpdate=function(e){var t=o.props.callback,r=o.context.store;if(t)r.dispatch((0,p.replace)(t));else{var a=(0,p.StoreStateRouterLocationURI)(r);r.dispatch((0,p.replace)(a.href()))}},o.state={create:!!e.create},o}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.organization;return u.default.createElement("span",{className:"float-right ml10"},u.default.createElement("button",{className:"RepositoryCreateButton btn btn-success",onClick:function(t){return e.setState({create:!0})}},u.default.createElement(v.GoRepo,null)," 新建仓库"),u.default.createElement(f.RModal,{when:this.state.create,onClose:function(t){return e.setState({create:!1})},onResolve:this.handleUpdate},u.default.createElement(h.default,{title:"新建仓库",organization:t})))}}]),t}(c.Component));g.contextTypes={store:p.PropTypes.object.isRequired},g.propTypes={create:p.PropTypes.bool,callback:p.PropTypes.string,organization:p.PropTypes.object};var R=t.RepositoriesTypeDropdown=function(e){function t(){var e,o,r,i;a(this,t);for(var l=arguments.length,s=Array(l),c=0;c<l;c++)s[c]=arguments[c];return o=r=n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.handlePush=function(e){var t=r.context.store;t.dispatch((0,p.push)(e))},i=o,n(r,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.url;return u.default.createElement("select",{className:"RepositoriesTypeDropdown form-control float-left w160 mr12",value:t,onChange:function(t){return e.handlePush(t.target.value)},size:"1"},u.default.createElement("option",{value:"/repository/joined"},"我拥有和加入的仓库"),u.default.createElement("option",{value:"/repository/all"},"所有仓库"))}}]),t}(c.Component);R.contextTypes={store:p.PropTypes.object.isRequired};var E=t.SearchGroup=function(e){function t(e){a(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.handleSearch=function(){var e=o.context.store,t=e.getState().router.location,r=t.pathname,a=t.hash,n=t.search,i=(0,p.URI)(r+a+n).removeSearch("cursor");o.state.name?i.setSearch("name",o.state.name):i.removeSearch("name"),e.dispatch((0,p.push)(i.href()))},o.state={name:e.name||""},o}return i(t,e),s(t,[{key:"render",value:function(){var e=this;return u.default.createElement("input",{type:"text",value:this.state.name,className:"form-control float-left w280",placeholder:"搜索仓库：输入名称或 ID",autoComplete:"off",onChange:function(t){return e.setState({name:t.target.value.trim()})},onKeyUp:function(t){return 13===t.which&&e.handleSearch()},ref:function(t){e.$input=t}})}},{key:"componentDidMount",value:function(){this.state.name&&this.$input.focus()}}]),t}(c.Component);E.contextTypes={store:p.PropTypes.object};var w=(t.RepositoryListWithSpin=function(e){var t=e.name,o=e.repositories;return o.fetching?u.default.createElement(f.Spin,null):u.default.createElement(m.default,{name:t,repositories:o.data,editor:"/repository/editor"})},t.OrganizationRepositoryListWithSpin=function(e){var t=e.name,o=e.repositories;return o.fetching?u.default.createElement(f.Spin,null):u.default.createElement(m.default,{name:t,repositories:o.data,editor:"/organization/repository/editor"})},t.PaginationWithLocation=function(e){function t(){return a(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.calculated,t=this.context.location;return u.default.createElement(f.Pagination,{location:t,calculated:e})}}]),t}(c.Component));w.contextTypes={location:p.PropTypes.object}},57:function(e,t,o){t=e.exports=o(22)(),t.push([e.id,".RepositoryListWrapper{padding:2rem}.RepositoryListWrapper>.header{margin-bottom:1rem}.RepositoryListWrapper>.header .title{font-size:2rem}.RepositoryListWrapper>.toolbar{margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #e1e4e8}.RepositoryListWrapper>.toolbar select.RepositoriesTypeDropdown{margin-right:.5rem;margin-bottom:.5rem;font-size:1.4rem}.RepositoryListWrapper>.toolbar button.RepositoryCreateButton{padding:.4rem 1rem;font-size:1.4rem}.RepositoryListWrapper>.toolbar .form-control{margin-bottom:.5rem}.RepositoryListWrapper>.body{margin-bottom:2rem}.RepositoryList .Repository.card{margin-bottom:1rem}.RepositoryList .Repository.card .card-block{position:relative}.RepositoryList .Repository.card .card-block .name{font-size:1.4rem;white-space:nowrap;overflow:hidden}.RepositoryList .Repository.card .card-block .desc{margin-top:1rem;height:6rem;overflow:hidden;color:#666}.RepositoryList .Repository.card .card-block .members{display:none;height:2.5rem}.RepositoryList .Repository.card .card-block .members .avatar{width:2.5rem;height:2.5rem;border-radius:50%}.RepositoryList .Repository.card .card-block .toolbar{position:absolute;top:1.2rem;right:1.25rem;background-color:#fff}.RepositoryList .Repository.card .card-block .toolbar>.fake-link,.RepositoryList .Repository.card .card-block .toolbar>a{margin:0 0 0 .5rem;font-size:1.4rem;color:#999}.RepositoryList .Repository.card .card-block .toolbar>.fake-link:hover,.RepositoryList .Repository.card .card-block .toolbar>a:hover{color:#4a7bf7}.RepositoryList .Repository.card .card-block.card-footer{padding-top:0;background-color:#fff;border-top:none;color:#666}.RepositoryList .Repository.card .card-block.card-footer .ownername{float:left}.RepositoryList .Repository.card .card-block.card-footer .fromnow{float:right}.RepositoryList .Repository.card:hover .card-block .toolbar{display:block}",""])},58:function(e,t,o){var r=o(57);"string"==typeof r&&(r=[[e.id,r,""]]);o(24)(r,{});r.locals&&(e.exports=r.locals)},331:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),s=o(1),c=r(s),u=o(14),p=o(54);o(58);var f=function(e){function t(){var e,o,r,i;a(this,t);for(var l=arguments.length,s=Array(l),c=0;c<l;c++)s[c]=arguments[c];return o=r=n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),r.getChildContext=p.getChildContext.bind(r),i=o,n(r,i)}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.location,o=e.match,r=e.repositories;return c.default.createElement("section",{className:"RepositoryListWrapper"},c.default.createElement("nav",{className:"toolbar clearfix"},c.default.createElement(p.RepositoriesTypeDropdown,{url:o.url}),c.default.createElement(p.SearchGroup,{name:t.params.name})),c.default.createElement("div",{className:"body"},c.default.createElement(p.RepositoryListWithSpin,{name:t.params.name,repositories:r})),c.default.createElement("div",{className:"footer"},c.default.createElement(p.PaginationWithLocation,{calculated:r.pagination})))}}]),t}(s.Component);f.contextTypes=p.contextTypes,f.propTypes={},f.childContextTypes=p.childContextTypes;var d=function(e){return{joiner:e.auth,repositories:e.repositories}};t.default=(0,u.connect)(d,p.mapDispatchToProps)(f)}});
//# sourceMappingURL=4.9545859b.chunk.js.map