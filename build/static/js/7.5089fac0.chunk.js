webpackJsonp([7],{50:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(17),f=a(s),p=n(14),d=n(16),m=n(21),h=(a(m),n(6)),b=function(){return{name:"",description:"",logo:"",ownerId:void 0,members:[]}},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));y.call(n);var a=e.organization;return n.state=a?Object.assign({},a,{members:a.members.filter(function(e){return!!e}),newOwner:a.owner}):b(),n}return i(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.context.rmodal,n=this.props.auth;return u.default.createElement("section",null,u.default.createElement("div",{className:"rmodal-header"},u.default.createElement("span",{className:"rmodal-title"},this.props.title)),u.default.createElement(h.RParsley,{ref:function(t){e.rparsley=t}},u.default.createElement("form",{className:"form-horizontal w600",onSubmit:this.handleSubmit},u.default.createElement("div",{className:"rmodal-body"},this.state.id&&u.default.createElement("div",{className:"form-group row"},u.default.createElement("label",{className:"col-sm-2 control-label"},"拥有者："),u.default.createElement("div",{className:"col-sm-10"},this.state.owner&&this.state.owner.id===n.id?u.default.createElement(h.MembersInput,{value:this.state.newOwner?[this.state.newOwner]:[],limit:1,onChange:function(t){return e.setState({newOwner:t[0]})}}):u.default.createElement("div",{className:"pt7 pl9"},this.state.owner.fullname))),u.default.createElement("div",{className:"form-group row"},u.default.createElement("label",{className:"col-sm-2 control-label"},"名称："),u.default.createElement("div",{className:"col-sm-10"},u.default.createElement("input",{name:"name",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})},className:"form-control",placeholder:"Name",spellCheck:"false",autoFocus:"true",required:!0,"data-parsley-trigger":"change keyup","data-parsley-maxlength":"256"}))),u.default.createElement("div",{className:"form-group row"},u.default.createElement("label",{className:"col-sm-2 control-label"},"简介："),u.default.createElement("div",{className:"col-sm-10"},u.default.createElement(h.SmartTextarea,{name:"description",value:this.state.description,onChange:function(t){return e.setState({description:t.target.value})},className:"form-control",placeholder:"Description",spellCheck:"false",rows:"5","data-parsley-trigger":"change keyup","data-parsley-maxlength":"1024"}))),u.default.createElement("div",{className:"form-group row"},u.default.createElement("label",{className:"col-sm-2 control-label"},"成员："),u.default.createElement("div",{className:"col-sm-10"},u.default.createElement(h.MembersInput,{value:this.state.members,onChange:function(t){return e.setState({members:t})}})))),u.default.createElement("div",{className:"rmodal-footer"},u.default.createElement("div",{className:"form-group row mb0"},u.default.createElement("label",{className:"col-sm-2 control-label"}),u.default.createElement("div",{className:"col-sm-10"},u.default.createElement("button",{type:"submit",className:"btn btn-success w140 mr20"},"提交"),u.default.createElement(d.Link,{to:"",onClick:function(e){e.preventDefault(),t.close()},className:"mr10"},"取消")))))))}}]),t}(c.Component);g.contextTypes={rmodal:f.default.object.isRequired,onAddOrganization:f.default.func.isRequired,onUpdateOrganization:f.default.func.isRequired},g.propTypes={auth:f.default.object.isRequired,organization:f.default.object};var y=function(){var e=this;this.handleSubmit=function(t){t.preventDefault();var n=e.context,a=n.onAddOrganization,r=n.onUpdateOrganization,o=e.state.id?r:a,i=Object.assign({},e.state,{memberIds:(e.state.members||[]).map(function(e){return e.id})}),l=e.state,c=l.owner,u=l.newOwner;u&&u.id!==c.id&&(i.ownerId=u.id),o(i,function(){var t=e.context.rmodal;t&&t.resolve()})}},v=function(e){return{auth:e.auth}},O={};t.default=(0,p.connect)(v,O)(g)},51:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(){var e=this.props,t=e.history,n=e.location,a=e.match,r=e.onAddOrganization,o=e.onDeleteOrganization,i=e.onUpdateOrganization,l=e.auth;return{history:t,location:n,match:a,onAddOrganization:r,onDeleteOrganization:o,onUpdateOrganization:i,auth:l}}function u(e,t){var n=this;e.preventDefault();var a="团队被删除后不可恢复！\n确认继续删除『#"+t.id+" "+t.name+"』吗？";if(window.confirm(a)){var r=this.context.onDeleteOrganization;r(t.id,function(){n.replaceLocation()})}}function s(){var e=this.context.store,t=(0,b.StoreStateRouterLocationURI)(e);e.dispatch((0,b.replace)(t.href()))}function f(e,t){var n=this;e.preventDefault();var a=this.context,o=a.auth,i=a.onUpdateOrganization,l={id:t.id,memberIds:[].concat(r(t.members.map(function(e){return e.id})),[o.id])};i(l,function(){n.replaceLocation()})}function p(e,t){var n=this;e.preventDefault();var a="确认继续退出『#"+t.id+" "+t.name+"』吗？";if(window.confirm(a)){var r=this.context,o=r.auth,i=r.onUpdateOrganization,l={id:t.id,memberIds:t.members.filter(function(e){return e.id!==o.id}).map(function(e){return e.id})};i(l,function(){n.replaceLocation()})}}Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationWithLocation=t.OrganizationListWithSpin=t.SearchGroup=t.OrganizationsTypeDropdown=t.CreateButton=t.mapDispatchToProps=t.childContextTypes=t.contextTypes=void 0;var d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.getChildContext=c,t.handleDelete=u,t.replaceLocation=s,t.handleJoin=f,t.handleExit=p;var m=n(1),h=a(m),b=n(5),g=n(6),y=n(80),v=a(y),O=n(50),z=a(O),E=n(49),w=n(11),_=(t.contextTypes={store:b.PropTypes.object},t.childContextTypes={history:b.PropTypes.object,location:b.PropTypes.object,match:b.PropTypes.object,onAddOrganization:b.PropTypes.func,onDeleteOrganization:b.PropTypes.func,onUpdateOrganization:b.PropTypes.func,auth:b.PropTypes.object},t.mapDispatchToProps={onAddOrganization:E.addOrganization,onDeleteOrganization:E.deleteOrganization,onUpdateOrganization:E.updateOrganization},t.CreateButton=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleUpdate=function(e){var t=n.context.store,a=(0,b.StoreStateRouterLocationURI)(t);t.dispatch((0,b.replace)(a.href()))},n.state={create:!1},n}return l(t,e),d(t,[{key:"render",value:function(){var e=this;return h.default.createElement("span",{className:"float-right ml10"},h.default.createElement("button",{className:"OrganizationCreateButton btn btn-success",onClick:function(t){return e.setState({create:!0})}},h.default.createElement(w.GoOrganization,null)," 新建团队"),this.state.create&&h.default.createElement(g.RModal,{when:this.state.create,onClose:function(t){return e.setState({create:!1})},onResolve:this.handleUpdate},h.default.createElement(z.default,{title:"新建团队"})))}}]),t}(m.Component));_.contextTypes={store:b.PropTypes.object.isRequired};var j=t.OrganizationsTypeDropdown=function(e){function t(){var e,n,a,r;o(this,t);for(var l=arguments.length,c=Array(l),u=0;u<l;u++)c[u]=arguments[u];return n=a=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.handlePush=function(e){var t=a.context.store;t.dispatch((0,b.push)(e))},r=n,i(a,r)}return l(t,e),d(t,[{key:"render",value:function(){var e=this,t=this.props.url;return h.default.createElement("select",{className:"OrganizationsTypeDropdown form-control float-left w160 mr12",value:t,onChange:function(t){return e.handlePush(t.target.value)},size:"1"},h.default.createElement("option",{value:"/organization/joined"},"我拥有和加入的团队"),h.default.createElement("option",{value:"/organization/all"},"全部团队"))}}]),t}(m.Component);j.contextTypes={store:b.PropTypes.object.isRequired};var P=t.SearchGroup=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSearch=function(){var e=n.context.store,t=e.getState().router.location,a=t.pathname,r=t.hash,o=t.search,i=(0,b.URI)(a+r+o).removeSearch("cursor");n.state.name?i.setSearch("name",n.state.name):i.removeSearch("name"),e.dispatch((0,b.push)(i.href()))},n.state={name:e.name||""},n}return l(t,e),d(t,[{key:"render",value:function(){var e=this;return h.default.createElement("input",{type:"text",value:this.state.name,className:"form-control float-left w280",placeholder:"搜索团队：输入名称或 ID",autoComplete:"off",onChange:function(t){return e.setState({name:t.target.value.trim()})},onKeyUp:function(t){return 13===t.which&&e.handleSearch()},ref:function(t){e.$input=t}})}},{key:"componentDidMount",value:function(){this.state.name&&this.$input.focus()}}]),t}(m.Component);P.contextTypes={store:b.PropTypes.object};var N=(t.OrganizationListWithSpin=function(e){var t=e.name,n=e.organizations;return n.fetching?h.default.createElement(g.Spin,null):h.default.createElement(v.default,{name:t,organizations:n.data})},t.PaginationWithLocation=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),d(t,[{key:"render",value:function(){var e=this.props.calculated,t=this.context.location;return h.default.createElement(g.Pagination,{location:t,calculated:e})}}]),t}(m.Component));N.contextTypes={location:b.PropTypes.object}},79:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(14),f=n(17),p=a(f),d=n(16),m=n(51),h=n(6),b=n(50),g=a(b),y=n(11),v=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.replaceLocation=m.replaceLocation,n.handleUpdate=m.replaceLocation,n.handleDelete=m.handleDelete,n.handleJoin=m.handleJoin,n.handleExit=m.handleExit,n.state={update:!1},n}return i(t,e),l(t,[{key:"render",value:function(){var e=this,n=this.context.auth,a=this.props.organization,r=a.owner.id===n.id,o=a.members.find(function(e){return e.id===n.id}),i=!1;return u.default.createElement("section",{className:"Organization card"},u.default.createElement("div",{className:"card-block"},u.default.createElement("div",{className:"header clearfix"},u.default.createElement("span",{className:"title"},u.default.createElement(y.GoOrganization,{className:"mr6 color-9"}),u.default.createElement(d.Link,{to:"/organization/repository?organization="+a.id},a.name)),u.default.createElement("span",{className:"toolbar"},r||o?u.default.createElement("span",{className:"fake-link operation mr5",onClick:function(t){return e.setState({update:!0})}},"编辑"):null,this.state.update&&u.default.createElement(h.RModal,{when:this.state.update,onClose:function(t){return e.setState({update:!1})},onResolve:function(t){return e.handleUpdate()}},u.default.createElement(g.default,{title:"编辑团队 #"+a.id,organization:a})),r?u.default.createElement(d.Link,{to:"",onClick:function(t){return e.handleDelete(t,a)},className:"operation mr5"},"删除"):null,!r&&o?u.default.createElement(d.Link,{to:"",onClick:function(t){return e.handleExit(t,a)},className:"operation mr5"},"退出"):null,r||o||!i?null:u.default.createElement(d.Link,{to:"",onClick:function(t){return e.handleJoin(t,a)},className:"operation mr5"},"加入"))),u.default.createElement("div",{className:"body"},u.default.createElement("div",{className:"desc"},a.description),u.default.createElement("div",{className:"members"},u.default.createElement(h.Popover,{content:a.owner.fullname+" "+a.owner.id},u.default.createElement("img",{alt:a.owner.fullname,src:t.avatar(a.owner),className:"avatar owner"})),a.members.map(function(e){return u.default.createElement(h.Popover,{key:e.id,content:e.fullname+" "+e.id},u.default.createElement("img",{alt:e.fullname,title:e.fullname,src:t.avatar(e),className:"avatar"}))})))))}}],[{key:"avatar",value:function(e){return"https://work.alibaba-inc.com/photo/"+e.empId+".220x220.jpg"}}]),t}(c.Component);v.contextTypes={store:p.default.object,onAddOrganization:p.default.func,onDeleteOrganization:p.default.func,onUpdateOrganization:p.default.func,auth:p.default.object};var O=function(e){return{}},z={};t.default=(0,s.connect)(O,z)(v)},80:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(5),f=n(79),p=a(f),d=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.organizations;return n.length?u.default.createElement("div",{className:"OrganizationList"},n.map(function(e){return u.default.createElement(p.default,{key:e.id,organization:e})})):t?u.default.createElement("div",{className:"fontsize-14 text-center p40"},"没有找到匹配 ",u.default.createElement("strong",null,t)," 的团队。"):u.default.createElement("div",{className:"fontsize-14 text-center p40"},"没有数据。")}}]),t}(c.Component);d.propTypes={name:s.PropTypes.string,organizations:s.PropTypes.array.isRequired};var m=function(e){return{}},h={};t.default=(0,s.connect)(m,h)(d)},84:function(e,t,n){t=e.exports=n(22)(),t.push([e.id,".OrganizationListWrapper{padding:2rem}.OrganizationListWrapper>.header{margin-bottom:2rem}.OrganizationListWrapper>.header .title{font-size:2rem}.OrganizationListWrapper>.toolbar{margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid #e1e4e8}.OrganizationListWrapper>.toolbar select.OrganizationsTypeDropdown{margin-right:.5rem;font-size:1.4rem}.OrganizationListWrapper>.toolbar button.OrganizationCreateButton{padding:.4rem 1rem;font-size:1.4rem}.OrganizationListWrapper>.toolbar .form-control{margin-bottom:0}.OrganizationListWrapper .OrganizationList .Organization.card{margin-bottom:1rem}.OrganizationListWrapper .OrganizationList .Organization.card .card-block>.header .title{margin-bottom:.5rem;font-size:1.4rem}.OrganizationListWrapper .OrganizationList .Organization.card .card-block>.header .toolbar{float:right;display:none;margin-left:1rem}.OrganizationListWrapper .OrganizationList .Organization.card .card-block>.body .desc{margin-bottom:.5rem;color:#666}.OrganizationListWrapper .OrganizationList .Organization.card .card-block>.body .members .avatar{margin-right:.2rem;width:2.5rem;height:2.5rem;border-radius:50%}.OrganizationListWrapper .OrganizationList .Organization.card .card-block>.body .members .avatar.owner{margin-right:1rem}.OrganizationListWrapper .OrganizationList .Organization.card .card-block>.body .members .popover{white-space:nowrap}.OrganizationListWrapper .OrganizationList .Organization.card .card-block:hover>.header .toolbar{display:inline-block}",""])},85:function(e,t,n){var a=n(84);"string"==typeof a&&(a=[[e.id,a,""]]);n(24)(a,{});a.locals&&(e.exports=a.locals)},328:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),u=a(c),s=n(14),f=n(51);n(85);var p=function(e){function t(){var e,n,a,i;r(this,t);for(var l=arguments.length,c=Array(l),u=0;u<l;u++)c[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.getChildContext=f.getChildContext,i=n,o(a,i)}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.location,n=e.match,a=e.organizations;return u.default.createElement("section",{className:"OrganizationListWrapper"},u.default.createElement("nav",{className:"toolbar clearfix"},u.default.createElement(f.OrganizationsTypeDropdown,{url:n.url}),u.default.createElement(f.SearchGroup,{name:t.params.name}),u.default.createElement(f.CreateButton,null)),u.default.createElement("div",{className:"body"},u.default.createElement(f.OrganizationListWithSpin,{name:t.params.name,organizations:a})),u.default.createElement("div",{className:"footer"},u.default.createElement(f.PaginationWithLocation,{calculated:a.pagination})))}}]),t}(c.Component);p.contextTypes=f.contextTypes,p.childContextTypes=f.childContextTypes;var d=function(e){return{auth:e.auth,organizations:e.organizations}};t.default=(0,s.connect)(d,f.mapDispatchToProps)(p)}});
//# sourceMappingURL=7.5089fac0.chunk.js.map